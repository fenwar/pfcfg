#!/bin/bash

# Quickly mount my Pennant CIFS shares below ~/mnt/sharename

# Usage: sudo mn //server/sharename

DOMAIN=pencom.local
SHAREUSER=paulf

if [[ -z ${PENCOM_PSWD} ]] ; then
    read -s -p "Password for ${DOMAIN}\\${SHAREUSER}: " PENCOM_PSWD
    echo
fi

LOCALBASE=${HOME}/mnt
LOCALUSER=${USER}

SHARENAME=${1}
LOCALPATH=${LOCALBASE}/$(basename ${SHARENAME} | tr '[:upper:]' '[:lower:]')

CIFS_OPTS="vers=2.0"

mkdir -p ${LOCALPATH}
sudo mount -t cifs \
    -ousername=${SHAREUSER},uid=${LOCALUSER},password=${PENCOM_PSWD},domain=${DOMAIN},${CIFS_OPTS} \
    ${SHARENAME} ${LOCALPATH}

